---
title: "What is GAN?"
date: 2020-07-25 18:37:00 -0400
categories: GAN
---


## GAN이란? 

**GAN은 ‘Generative Adversarial Network’의 약자다. 이 세글자의 뜻을 풀어보는 것으로 GAN에 대한 전반적 이해를 할 수 있다.**

첫단어인 'Generate'은 GAN이 생성(Ganeration) 모델이라는 것을 뜻한다 생성모델이란 '사실을 기반으로는 정교한 가짜' 라고 할 수 있다.  
즉 현실세계에 존재하지 않지만 현실세계에 존재 할 것만 같은 모델을 생성해 낸다는 것을 의미한다. 

![ganexam](http://sanghyukchun.github.io/images/post/92-3.png)

그렇다면 있을 법하다는 것을 어떻게 정의를 해야할까? 수학적 실제데이터의 분포와 만들어낸 데이터의 분포를 비교하여 비슷하면 가능하다.  
예를들어 귀여운 고양이를 떠올려 보자 그리고 고양이를 정의 하는 데이터를 몸통 길이와 다리길이라 가정해보자 고양이의 종류는 나는 잘모르지만 일단 적지는 않을 것이다 하지만 몸통길이가 1M 다리길이가 1M 씩하는 고양이는 현실세계에서는 듣도 보지도 못하였을 것이다 이러한 조합은 실제 데이터 분포에서는 거의 나오지 않는 조합이기 떄문이다 따라서 우리가 만들고자 하는 것은 수학적으로 생성모델을 만들어 이 모델이 실제 데이터 분포와 근사하게 만드는 것이 목표로 삼아야 한다.

이 세상에 고양이를 몸통길이와 다리길이로 모든 특징을 구현할 수 있으면 좋겠지만 현실은 그렇지 않다 만약 이미지 파일의 크기가 256x256픽셀인 경우 RGB컬러 값까지 총 256x256x3의 경우를 모두 고려해야 한다. 그 변수들의 조합은 우연하게 고양이 처럼 보이는 픽셀 값을 가지게 된다면 문제 가 없지만 이는 상당히 희망적인 관측론이고 실제로는 매우 어려운 문제이다. 하지만 발전하는 딥러닝 기술은 이를 가능캐 하였다.

GAN의 두번째 단어인 A는 'Adversarial' 의 약자이다. 이는 GAN이 두 개의 모델을 적대적(Adversarial)적으로 경쟁시키며 발전시킨다는 의미이다. 뜬금없지만 위조지폐범과 경창을 생각해보자. 이둘은 적대적인 관계이다 위조지폐범이 경찰을 속이기 위하여 위조지폐기술은 더욱 발전할 것이고 이를 판별하기 위해 경찰의 판별기술 또한 발전할 것이다. 이윽고 시간이 흐르면 위조지폐범의 위폐 제조 기술은 완벽에 가까울 것이다.

위의 예처럼 GAN은 위조지폐범에 해당하는 생성자(generrator) 역할 그리고 경창에 해당하는 구분자(discvriminer)의 역할을 가지게 된다. 생성자의 목적은 진짜와 같은 가짜데이터를 생성하여 구분자를 속이는 것이며 구분자의 목적은 생성자가 만든 가짜 데이터를 구분하는 것이다. 이둘을 함께 학습 시키면서 진짜와 구분할 수 없는 가짜를 만들어 내는 생성자를 얻을 수 있다. 이것이 바로 GAN의 핵심아이디어인 적대자 학습(Adverarial Learning)이다.

![gan](https://files.slack.com/files-pri/T25783BPY-F9SHTP6F9/picture2.png?pub_secret=6821873e68)

GAN의 마지막 단어인 N은 "Network' 이다. 이는 이 모델이 인공신경망(Artifical Nerual Network) 혹은 딥러닝(Depp Leraning)으로 만들어 졌기 때문에 포함되었다. 하지만 적대적 학습을 위하며 무조건 딥러닝을 써야 하는건 아니다 하지만 딥러닝 구조의 강력한 모델링은 강력한 머신러닝 구조를 만들 수 있게 해준다 딥러닝이 어러한 힘을 얻게 비결은 비선형 활성함수(non-Linear Activation Function)와 계층(Hierarchy)구조, 그리고 역전파(Backpropagation)으로 꼽을 수 있다.

## GAN의 작동 원리

GAN 의 동작 단게는 다음과 같다.

* generator가 임의의 수를 입력받아 생성한 이미지로 반환한다.

* 이렇게 생성된 이미지는 실제 데이터 세트에서 가져온 이미지들과 함께 discriminator에 전달된다.

* discriminator은 실제 이미지와 가짜 이미지를 판별하여 0과 1사이의 확률값으로 반호나한다 1은 실제이미지, 0은 가짜 이미지를 의미한다

따라서 이중 피드백 루프를 갖게 된다.

* discriminator는 이미지의 정답 값으로 부터 피드백을 받는다.

* generator는 discriminator로 부터 피드백을 받는다.

![gnas](https://pathmind.com/images/wiki/gan_schema.png)

discriminator 네트워크가 전달된 이미지를 실제 이미지인지 가짜 이미지인지를 판별할 수 있는 일반적인 컨볼루션 네트워크라면 generator는 정반대의 컨볼루션 네트워크이다. 일반 컨볼루션 분류기는 이미지를 입력받아 확률을 예측하기 위해 이를 다운 샘플링하는 반면 generator는 랜덤 노이즈 벡터를 입력받아 이미지를 만드는 업샘플링을 한다, 즉 일반적인 컨볼루션 네트워크는 maxpooling 과 같은 다운 샘플링 기술을 사용하여 데이터를 처리하고 generator와 같은 inverse 컨볼루션 네트워크는 새로운 데이터를 생성한다.

```
업 샘플링은 해당 분류에 속하는 데이터가 적은 쪽을 표본으로 더 많이 추출하는 방법이며, 다운 샘플링은 데이터가 많은 쪽을 적게 추출하는 방법이다.
```
두 네트워크 모두 제로섬 게임처럼 서로 반대되는 목적함수 또는 손실함수를 통해 최적화하려고 시도한다 이것은 actor-critic model과 비슷하다. discriminator의 행동이 바뀌면 generator의 행동도 변하고 그 반대의 경우도 마찬가지이다. 각 에러는 서로에게 전달된다.

![gannetwork](https://pathmind.com/images/wiki/GANs.png)

## GAN의 전성시대를 연 DCGAN(Depp Convolution GAN

GAN은 학습이 불안적하기로 악명이 높다 









